<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Currency Converter — One Click</title>
  <link rel="stylesheet" href="../assets/css/style.css" />
  <style>.grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;}@media(max-width:768px){.grid{grid-template-columns:1fr;}}</style>
</head>
<body>
  <div id="header-container"></div>
  <main class="tool-container">
    <div class="tool-header">
      <h1>Currency Converter</h1>
      <p>Convert between currencies using live exchange rates (via exchangerate.host) or custom rates.</p>
    </div>

    <div class="tool-interface">
      <div class="grid">
        <div class="form-group">
          <label for="amount">Amount</label>
          <input id="amount" class="form-control" type="number" value="1" />
        </div>
        <div class="form-group">
          <label for="from">From</label>
          <input id="from" class="form-control" value="USD" />
        </div>
        <div class="form-group">
          <label for="to">To</label>
          <input id="to" class="form-control" value="INR" />
        </div>
        <div class="form-group">
          <label for="rate">Custom rate (optional)</label>
          <input id="rate" class="form-control" placeholder="If set, skips API e.g., 83.2" />
        </div>
      </div>
      <div class="d-flex" style="gap:10px;flex-wrap:wrap;">
        <button id="convertBtn" class="btn btn-primary">Convert</button>
        <button id="swapBtn" class="btn btn-primary">Swap</button>
      </div>
      <div class="result-area mt-3" id="result">—</div>
    </div>

    <div class="ad-space"><h4>Advertisement</h4><p>300x250</p></div>
  </main>
  <div id="footer-container"></div>

  <script src="../assets/js/common.js"></script>
  <script>
    async function fetchRate(base, symbol){
      const url = `https://api.exchangerate.host/latest?base=${encodeURIComponent(base)}&symbols=${encodeURIComponent(symbol)}`;
      const res = await fetch(url);
      const data = await res.json();
      if (!data || !data.rates || data.rates[symbol] == null) throw new Error('Rate not available');
      return data.rates[symbol];
    }

    document.getElementById('swapBtn').addEventListener('click', ()=>{
      const a=document.getElementById('from').value; const b=document.getElementById('to').value;
      document.getElementById('from').value=b; document.getElementById('to').value=a;
    });

    document.getElementById('convertBtn').addEventListener('click', async ()=>{
      const amount = parseFloat(document.getElementById('amount').value)||0;
      const from = document.getElementById('from').value.trim().toUpperCase();
      const to = document.getElementById('to').value.trim().toUpperCase();
      const custom = document.getElementById('rate').value.trim();
      if (!amount || !from || !to) return showNotification('Enter values', 'error');
      try{
        const rate = custom ? parseFloat(custom) : await fetchRate(from, to);
        if (!rate || isNaN(rate)) throw new Error('Invalid rate');
        const out = amount * rate;
        document.getElementById('result').innerHTML = `<strong>${amount} ${from}</strong> ≈ <strong>${out.toFixed(4)} ${to}</strong><br><small>Rate: ${rate}</small>`;
      } catch(e){ showNotification('Failed to fetch rate', 'error'); }
    });
  </script>
</body>
</html>
