<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JavaScript Minifier - One Click Tools</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="../css/style.css">
  <style>
    .minifier-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin: 20px 0;
    }
    .code-section {
      background: #f8f9fa;
      border: 1px solid #e9ecef;
      border-radius: 8px;
      padding: 15px;
    }
    .code-section h4 {
      margin: 0 0 15px 0;
      color: #495057;
      font-size: 1.1rem;
    }
    .code-input, .code-output {
      width: 100%;
      min-height: 300px;
      padding: 15px;
      border: 2px solid #e9ecef;
      border-radius: 6px;
      font-family: 'Monaco', 'Consolas', monospace;
      font-size: 0.9rem;
      resize: vertical;
      line-height: 1.4;
    }
    .code-input {
      background: #2d3748;
      color: #e2e8f0;
    }
    .code-output {
      background: #1a202c;
      color: #a0aec0;
    }
    .file-upload {
      margin: 15px 0;
      padding: 15px;
      border: 2px dashed #cbd5e0;
      border-radius: 8px;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s;
    }
    .file-upload:hover {
      border-color: #007bff;
      background: #e7f0ff;
    }
    .file-upload.dragover {
      border-color: #28a745;
      background: #d4edda;
    }
    .minifier-controls {
      display: flex;
      gap: 10px;
      margin: 15px 0;
      flex-wrap: wrap;
    }
    .control-btn {
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.2s;
    }
    .btn-minify {
      background: #f7df1e;
      color: #000;
    }
    .btn-minify:hover {
      background: #e6c914;
    }
    .btn-clear {
      background: #6c757d;
      color: white;
    }
    .btn-clear:hover {
      background: #545b62;
    }
    .btn-copy {
      background: #28a745;
      color: white;
    }
    .btn-copy:hover {
      background: #218838;
    }
    .btn-upload {
      background: #17a2b8;
      color: white;
    }
    .btn-upload:hover {
      background: #138496;
    }
    .stats-panel {
      background: #e7f0ff;
      padding: 15px;
      border-radius: 8px;
      margin: 20px 0;
      border: 1px solid #b8daff;
    }
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 15px;
      margin-top: 15px;
    }
    .stat-item {
      background: white;
      padding: 12px;
      border-radius: 6px;
      text-align: center;
      border: 1px solid #dee2e6;
    }
    .stat-number {
      font-size: 1.5rem;
      font-weight: bold;
      color: #007bff;
      display: block;
    }
    .stat-label {
      font-size: 0.9rem;
      color: #6c757d;
    }
    .minification-options {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 8px;
      margin: 15px 0;
      border: 1px solid #e9ecef;
    }
    .option-group {
      margin-bottom: 10px;
    }
    .option-group label {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      font-weight: 500;
    }
    .option-group input[type="checkbox"] {
      margin: 0;
    }
    .warning-message {
      background: #fff3cd;
      color: #856404;
      padding: 10px;
      border-radius: 6px;
      margin: 10px 0;
      border: 1px solid #ffeaa7;
      font-size: 0.9rem;
    }
    .error-message {
      background: #f8d7da;
      color: #721c24;
      padding: 10px;
      border-radius: 6px;
      margin: 10px 0;
      border: 1px solid #f5c6cb;
    }
    .success-message {
      background: #d4edda;
      color: #155724;
      padding: 10px;
      border-radius: 6px;
      margin: 10px 0;
      border: 1px solid #c3e6cb;
    }
  </style>
</head>
<body>
  <div id="site-header"></div>
  <main class="container" style="padding:60px 0;">
    <div class="tool-card" style="max-width:1000px; margin:0 auto;">
      <div style="text-align:center;">
        <i class="fab fa-js tool-icon-small" style="font-size:3rem;"></i>
        <div class="tool-name" style="font-size:1.6rem;">JavaScript Minifier</div>
        <div class="tool-desc">Minify JavaScript code safely while preserving functionality. Reduce file size for faster loading.</div>
      </div>

      <div class="minifier-container">
        <div class="code-section">
          <h4>Input JavaScript</h4>
          <div class="file-upload" id="fileUpload">
            <i class="fas fa-upload" style="font-size:2rem; margin-bottom:8px;"></i>
            <div>Click or drag & drop JS file here</div>
            <div style="font-size:0.9rem; opacity:0.7;">Or paste JavaScript code below</div>
          </div>
          <textarea class="code-input" id="inputJS" placeholder="// Paste your JavaScript code here or upload a file"></textarea>
        </div>

        <div class="code-section">
          <h4>Minified JavaScript</h4>
          <textarea class="code-output" id="outputJS" placeholder="Minified JavaScript will appear here..." readonly></textarea>
        </div>
      </div>

      <div class="minification-options">
        <h4>Minification Options</h4>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
          <div class="option-group">
            <label><input type="checkbox" id="removeComments" checked> Remove Comments</label>
          </div>
          <div class="option-group">
            <label><input type="checkbox" id="removeWhitespace" checked> Remove Extra Whitespace</label>
          </div>
          <div class="option-group">
            <label><input type="checkbox" id="compressVariables" checked> Compress Variable Names</label>
          </div>
          <div class="option-group">
            <label><input type="checkbox" id="removeConsoleLogs" checked> Remove Console Logs</label>
          </div>
          <div class="option-group">
            <label><input type="checkbox" id="optimizeExpressions"> Optimize Expressions</label>
          </div>
          <div class="option-group">
            <label><input type="checkbox" id="mangleNames"> Mangle Function Names</label>
          </div>
        </div>
        <div class="warning-message">
          âš ï¸ <strong>Warning:</strong> Variable name compression and function name mangling may break code that relies on specific function/variable names. Use with caution in production.
        </div>
      </div>

      <div class="minifier-controls">
        <button class="control-btn btn-minify">Minify JavaScript</button>
        <button class="control-btn btn-clear">Clear All</button>
        <button class="control-btn btn-copy">Copy Minified</button>
        <button class="control-btn btn-upload">Upload File</button>
      </div>

      <div class="stats-panel" id="statsPanel" style="display:none;">
        <h4>Compression Results</h4>
        <div class="stats-grid">
          <div class="stat-item">
            <span class="stat-number" id="originalSize">0</span>
            <span class="stat-label">Original Size</span>
          </div>
          <div class="stat-item">
            <span class="stat-number" id="minifiedSize">0</span>
            <span class="stat-label">Minified Size</span>
          </div>
          <div class="stat-item">
            <span class="stat-number" id="savings">0%</span>
            <span class="stat-label">Space Saved</span>
          </div>
          <div class="stat-item">
            <span class="stat-number" id="compressionRatio">0:1</span>
            <span class="stat-label">Ratio</span>
          </div>
        </div>
      </div>

      <div id="messages"></div>

      <div style="background: #d1ecf1; padding: 12px; border-radius: 6px; margin: 15px 0; border: 1px solid #bee5eb; font-size: 0.9rem;">
        <strong>Tips:</strong>
        <ul style="margin:10px 0; padding-left:20px;">
          <li>Upload a JS file or paste your code directly</li>
          <li>Be careful with variable name compression for production code</li>
          <li>Test minified code thoroughly before using in production</li>
          <li>Check the compression statistics to see space savings</li>
        </ul>
      </div>

      <div class="banner-ad" style="margin-top:16px;">Ad Placeholder (728x90)</div>
      <div style="text-align:center; margin-top:8px;">
        <a class="tool-button" href="../index.html">Back to Home</a>
      </div>
    </div>
  </main>
  <div id="site-footer"></div>
  <script src="../js/include.js"></script>
  <script>
    const inputJS = document.getElementById('inputJS');
    const outputJS = document.getElementById('outputJS');
    const fileUpload = document.getElementById('fileUpload');
    const minifyBtn = document.querySelector('.btn-minify');
    const clearBtn = document.querySelector('.btn-clear');
    const copyBtn = document.querySelector('.btn-copy');
    const uploadBtn = document.querySelector('.btn-upload');
    const messages = document.getElementById('messages');
    const statsPanel = document.getElementById('statsPanel');
    const originalSize = document.getElementById('originalSize');
    const minifiedSize = document.getElementById('minifiedSize');
    const savings = document.getElementById('savings');
    const compressionRatio = document.getElementById('compressionRatio');

    // Minification options
    const removeComments = document.getElementById('removeComments');
    const removeWhitespace = document.getElementById('removeWhitespace');
    const compressVariables = document.getElementById('compressVariables');
    const removeConsoleLogs = document.getElementById('removeConsoleLogs');
    const optimizeExpressions = document.getElementById('optimizeExpressions');
    const mangleNames = document.getElementById('mangleNames');

    function showMessage(text, type = 'error') {
      messages.innerHTML = `<div class="${type}-message">${text}</div>`;
      setTimeout(() => {
        messages.innerHTML = '';
      }, 5000);
    }

    function formatBytes(bytes) {
      if (bytes === 0) return '0 Bytes';
      const k = 1024;
      const sizes = ['Bytes', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }

    function updateStats(original, minified) {
      originalSize.textContent = formatBytes(original);
      minifiedSize.textContent = formatBytes(minified);
      const saved = original - minified;
      const percent = original > 0 ? Math.round((saved / original) * 100) : 0;
      savings.textContent = percent + '%';
      compressionRatio.textContent = original > 0 ? `1:${Math.round(original / minified)}` : '1:1';
      statsPanel.style.display = 'block';
    }

    function minifyJS(js) {
      if (!js || !js.trim()) {
        showMessage('Please enter JavaScript code to minify');
        return '';
      }

      let minified = js;

      // Remove single-line comments (but preserve URLs and regex)
      if (removeComments.checked) {
        minified = minified.replace(/\/\/.*$/gm, '');
      }

      // Remove multi-line comments
      if (removeComments.checked) {
        minified = minified.replace(/\/\*[\s\S]*?\*\//g, '');
      }

      // Remove console.log statements
      if (removeConsoleLogs.checked) {
        minified = minified.replace(/console\.log\([^)]*\);?/g, '');
        minified = minified.replace(/console\.warn\([^)]*\);?/g, '');
        minified = minified.replace(/console\.error\([^)]*\);?/g, '');
        minified = minified.replace(/console\.info\([^)]*\);?/g, '');
      }

      // Remove extra whitespace
      if (removeWhitespace.checked) {
        // Remove leading/trailing whitespace
        minified = minified.trim();
        // Replace multiple spaces with single space
        minified = minified.replace(/\s+/g, ' ');
        // Remove spaces around operators and punctuation
        minified = minified.replace(/\s*([{}:;,+\-*/%=<>!&|^~()[\]])\s*/g, '$1');
        // Remove trailing spaces before newlines
        minified = minified.replace(/\s+\n/g, '\n');
        // Remove empty lines
        minified = minified.replace(/\n\s*\n/g, '\n');
      }

      // Basic variable name compression (simple implementation)
      if (compressVariables.checked) {
        // This is a very basic implementation - in production you'd want more sophisticated compression
        // Replace long variable names with shorter ones (basic example)
        const longNames = minified.match(/\b[a-zA-Z_$][a-zA-Z0-9_$]{3,}\b/g) || [];
        longNames.forEach((name, index) => {
          if (!['function', 'var', 'let', 'const', 'if', 'else', 'for', 'while', 'return', 'true', 'false', 'null', 'undefined'].includes(name)) {
            const shortName = 'a' + index;
            minified = minified.replace(new RegExp('\\b' + name + '\\b', 'g'), shortName);
          }
        });
      }

      // Optimize expressions (basic)
      if (optimizeExpressions.checked) {
        // Remove unnecessary semicolons
        minified = minified.replace(/;+/g, ';');
        minified = minified.replace(/;}/g, '}');
        minified = minified.replace(/;$/, '');

        // Simplify boolean expressions (basic)
        minified = minified.replace(/!+!/g, '!!');
        minified = minified.replace(/true\s*===\s*true/g, 'true===true');
        minified = minified.replace(/false\s*===\s*false/g, 'false===false');
      }

      // Basic function name mangling (dangerous - use with caution)
      if (mangleNames.checked) {
        // This is a very basic implementation
        const functionMatches = minified.match(/function\s+([a-zA-Z_$][a-zA-Z0-9_$]*)\s*\(/g) || [];
        functionMatches.forEach((match, index) => {
          const functionName = match.match(/function\s+([a-zA-Z_$][a-zA-Z0-9_$]*)/)[1];
          const shortName = 'f' + index;
          minified = minified.replace(new RegExp('\\b' + functionName + '\\b', 'g'), shortName);
        });
      }

      // Final cleanup
      minified = minified.trim();

      return minified;
    }

    function minifyAndDisplay() {
      const js = inputJS.value.trim();
      if (!js) {
        showMessage('Please enter JavaScript code to minify');
        return;
      }

      try {
        const originalSize = new Blob([js]).size;
        const minified = minifyJS(js);
        const minifiedSize = new Blob([minified]).size;

        outputJS.value = minified;
        updateStats(originalSize, minifiedSize);

        if (minified) {
          showMessage(`JavaScript minified successfully! Saved ${formatBytes(originalSize - minifiedSize)}`, 'success');
        }
      } catch (error) {
        showMessage('Error minifying JavaScript: ' + error.message);
      }
    }

    function clearAll() {
      inputJS.value = '';
      outputJS.value = '';
      statsPanel.style.display = 'none';
      messages.innerHTML = '';
    }

    function copyToClipboard() {
      const text = outputJS.value;
      if (!text) {
        showMessage('No minified JavaScript to copy');
        return;
      }

      navigator.clipboard.writeText(text).then(() => {
        copyBtn.textContent = 'Copied!';
        setTimeout(() => {
          copyBtn.textContent = 'Copy Minified';
        }, 1500);
      }).catch(() => {
        showMessage('Failed to copy to clipboard');
      });
    }

    function handleFileUpload(e) {
      const file = e.target.files[0];
      if (file && (file.type === 'text/javascript' || file.type === 'application/javascript' || file.name.endsWith('.js'))) {
        const reader = new FileReader();
        reader.onload = (e) => {
          inputJS.value = e.target.result;
          minifyAndDisplay();
        };
        reader.readAsText(file);
      } else {
        showMessage('Please select a valid JavaScript file');
      }
    }

    // Drag and drop functionality
    fileUpload.addEventListener('click', () => {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = '.js';
      input.addEventListener('change', handleFileUpload);
      input.click();
    });

    fileUpload.addEventListener('dragover', (e) => {
      e.preventDefault();
      fileUpload.classList.add('dragover');
    });

    fileUpload.addEventListener('dragleave', () => {
      fileUpload.classList.remove('dragover');
    });

    fileUpload.addEventListener('drop', (e) => {
      e.preventDefault();
      fileUpload.classList.remove('dragover');

      const files = e.dataTransfer.files;
      if (files.length > 0) {
        const file = files[0];
        if (file.type === 'text/javascript' || file.type === 'application/javascript' || file.name.endsWith('.js')) {
          const reader = new FileReader();
          reader.onload = (e) => {
            inputJS.value = e.target.result;
            minifyAndDisplay();
          };
          reader.readAsText(file);
        } else {
          showMessage('Please drop a valid JavaScript file');
        }
      }
    });

    // Event listeners
    minifyBtn.addEventListener('click', minifyAndDisplay);
    clearBtn.addEventListener('click', clearAll);
    copyBtn.addEventListener('click', copyToClipboard);

    inputJS.addEventListener('input', () => {
      // Auto-minify on input if there's content
      if (inputJS.value.trim()) {
        setTimeout(minifyAndDisplay, 1000);
      }
    });

    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      if (e.ctrlKey || e.metaKey) {
        switch (e.key) {
          case 'Enter':
            e.preventDefault();
            minifyAndDisplay();
            break;
          case 'k':
            e.preventDefault();
            clearAll();
            break;
        }
      }
    });

    // Warning for dangerous options
    compressVariables.addEventListener('change', (e) => {
      if (e.target.checked) {
        showMessage('âš ï¸ Variable name compression may break code that relies on specific variable names!', 'warning');
      }
    });

    mangleNames.addEventListener('change', (e) => {
      if (e.target.checked) {
        showMessage('âš ï¸ Function name mangling is dangerous and may break your code!', 'warning');
      }
    });
  </script>
</body>
</html>


