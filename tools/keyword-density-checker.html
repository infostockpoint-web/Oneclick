<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Keyword Density Checker â€” One Click</title>
  <link rel="stylesheet" href="../assets/css/style.css" />
</head>
<body>
  <div id="header-container"></div>
  <main class="tool-container">
    <div class="tool-header">
      <h1>Keyword Density Checker</h1>
      <p>Analyze keyword occurrence and density in your content.</p>
    </div>

    <div class="tool-interface">
      <div class="form-group">
        <label for="text">Text</label>
        <textarea id="text" class="form-control" rows="10" placeholder="Paste or type your content here..."></textarea>
      </div>
      <div class="d-flex" style="gap:10px;flex-wrap:wrap;">
        <div>
          <label for="n">N-gram length</label>
          <select id="n" class="form-control">
            <option value="1" selected>1 (single word)</option>
            <option value="2">2 (two words)</option>
            <option value="3">3 (three words)</option>
          </select>
        </div>
        <div>
          <label for="min">Minimum frequency</label>
          <input id="min" class="form-control" type="number" value="1" min="1" />
        </div>
        <div style="align-self:end;">
          <label><input type="checkbox" id="ignoreStop" checked> Ignore common stop-words</label>
        </div>
      </div>

      <button id="analyzeBtn" class="btn btn-primary mt-2">Analyze</button>

      <div class="result-area mt-3" id="result">No analysis yet.</div>
    </div>

    <div class="ad-space"><h4>Advertisement</h4><p>300x250</p></div>
  </main>
  <div id="footer-container"></div>

  <script src="../assets/js/common.js"></script>
  <script>
    const STOP = new Set(('a,an,the,of,to,in,and,or,for,with,as,is,are,was,were,be,by,that,this,these,those,on,at,from,into,up,down,over,under,again,further,then,once,here,there,all,any,both,each,few,more,most,other,some,such,no,nor,not,only,own,same,so,than,too,very,can,will,just,don,should,now,has,have,had,do,does,did,you,your,our,they,them,he,she,it,we,me,my,yours,ours,their,theirs,his,her,its').split(','));

    function tokenize(text){
      return (text.toLowerCase().match(/[a-z0-9']+/g) || []);
    }

    function ngrams(tokens, n, ignoreStop){
      const grams = [];
      if (n === 1){
        tokens.forEach(t => { if (!ignoreStop || !STOP.has(t)) grams.push(t); });
      } else {
        for (let i=0;i<=tokens.length-n;i++){
          const slice = tokens.slice(i, i+n);
          if (ignoreStop && slice.some(t => STOP.has(t))) continue;
          grams.push(slice.join(' '));
        }
      }
      return grams;
    }

    function analyze(){
      const text = document.getElementById('text').value || '';
      const n = parseInt(document.getElementById('n').value, 10) || 1;
      const min = Math.max(1, parseInt(document.getElementById('min').value, 10) || 1);
      const ignoreStop = document.getElementById('ignoreStop').checked;
      const tokens = tokenize(text);
      const grams = ngrams(tokens, n, ignoreStop);
      const total = grams.length || 1;
      const freq = new Map();
      grams.forEach(g => freq.set(g, (freq.get(g)||0) + 1));
      const list = [...freq.entries()].filter(([g,c]) => c >= min).sort((a,b)=>b[1]-a[1]);
      if (list.length === 0){
        document.getElementById('result').innerHTML = 'No results.';
        return;
      }
      const rows = list.slice(0,100).map(([g,c]) => `<tr><td>${g}</td><td>${c}</td><td>${((c/total)*100).toFixed(2)}%</td></tr>`).join('');
      document.getElementById('result').innerHTML = `<strong>Total ${n}-grams:</strong> ${total}<br><br><div style="overflow:auto;"><table style="width:100%;border-collapse:collapse;">
        <thead><tr><th style="text-align:left;border-bottom:1px solid #e9ecef;padding:6px 4px;">Keyword</th><th style="text-align:right;border-bottom:1px solid #e9ecef;padding:6px 4px;">Count</th><th style="text-align:right;border-bottom:1px solid #e9ecef;padding:6px 4px;">Density</th></tr></thead>
        <tbody>${rows}</tbody></table></div>`;
    }

    document.getElementById('analyzeBtn').addEventListener('click', analyze);
  </script>
</body>
</html>
